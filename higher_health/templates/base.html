{% load static %}
<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"> <![endif]-->
<!--[if IE 10]><html class="no-js lt-ie9 ie10"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US">
<!--<![endif]-->
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>{% if context.title %}{{ context.title }}{% else %}Higher Health â€“ Improving wellbeing. Inspiring success.{% endif %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#f2f2f2">

    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/icons/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="192x192" href="{% static 'images/icons/android-icon-192x192.png' %}">
    <link rel="icon" type="image/png" sizes="512x512" href="{% static 'images/icons/android-icon-512x512.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/icons/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/icons/favicon-16x16.png' %}">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/index.css' %}" media="all">
    <!-- TO DO: GOOGLE ANALYTICS -->
</head>
<body id="healthcheck">
  <section class="wrapper">
    <header id="masthead" class="header">
      <div class="header-inner">
        <div class="header-brand">
          <a class="header-brand__link" href="/" rel="home">
            <img class="header-brand__logo"  src="{% static 'images/hh-logo.png' %}" alt="Higherhealth Logo">
          </a>
        </div>
        <div class="header__menu">
          <ul class="menu">
            <li class="menu__item menu__item--current">
              <a href="#" class="menu__link"></a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    {% block content %}{% endblock %}
  </section>
  <footer class="footer">
    <div class="footer-inner">
      <div class="footer-content">
        HigherHealth &copy; {% now "Y" %}
      </div>
      <div class="footer-powered-by">
        <ul class="logo-list">
          <li class="logo-list__item">
            <a class="logo-list__anchor" href="http://higherhealth.ac.za/">
              <img class="logo-list__image" src="{% static 'images/footer-logo.png' %}" alt="Higherhealth Footer Logo" width="120" height="26,34">
            </a>
          </li>
          <li class="logo-list__item">
            <a class="logo-list__anchor" href="http://higherhealth.ac.za/">
              <img class="logo-list__image" src="{% static 'images/DHEAT-logo-white.png' %}" alt="Department of Higher Education and Training" width="120" height="46,88">
            </a>
          </li>
          <li class="logo-list__item">
            <a class="logo-list__anchor" href="http://praekelt.org">
              <img class="logo-list__image" src="{% static 'images/prk-logo.png' %}" alt="Praekelt" width="120" height="36,56">
            </a>
          </li>
          <li class="logo-list__item">
            <a class="logo-list__anchor" href="http://turn.io">
              <img class="logo-list__image" src="{% static 'images/turn-logo-white.png' %}" alt="Turn" width="78" height="31,65">
            </a>
          </li>
        </ul>
      </div>
    </div>
  </footer>
  {% block extra_js %}
    <script type="text/javascript">
    "use strict";
    const bodyBlock = document.getElementById('healthcheck'),
          checkbox = document.getElementById('healthcheck_terms'),
          questionnairesForm = document.getElementById('questionnaires');

  	document.addEventListener('DOMContentLoaded',function(e) {
      bodyBlock.addEventListener('scroll',function(e) {
				if(e.target.scrollTop > 185) {
          bodyBlock.classList.add('sticky');
				} else {
					bodyBlock.classList.remove('sticky');
				}
			});
      //Review & cleanup
      let checkboxKey = sessionStorage.getItem('checkbox');
      if(checkboxKey === 'true') {
        checkbox.checked = true;
        questionnairesForm.classList.add('showing');
        questionnairesForm.classList.remove('hidden');
      } else {
        checkbox.checked = false;
        questionnairesForm.classList.add('hidden');
        questionnairesForm.classList.remove('showing');
      }

			checkbox.addEventListener('change', function(e){
				if (e.target.checked) {
          sessionStorage.setItem('checkbox', 'true');
			    questionnairesForm.classList.add('showing');
          questionnairesForm.classList.remove('hidden');
			  } else {
          sessionStorage.setItem('checkbox', 'false');
			    questionnairesForm.classList.add('hidden');
          questionnairesForm.classList.remove('showing');
			  }
			});
    });


    /*----GOOGLE PLACES REVIEW----*/
    let placeSearch, autocomplete;
    const componentForm = {
      street_number: 'short_name',
      route: 'long_name',
      locality: 'long_name',
      country: 'long_name'
    };

    function initAutocomplete() {
      // Create the autocomplete object, restricting the search predictions to
      // geographical location types.
      autocomplete = new google.maps.places.Autocomplete(
          document.getElementById('autocomplete'), {types: ['geocode']});

      // Avoid paying for data that you don't need by restricting the set of
      // place fields that are returned to just the address components.
      autocomplete.setFields(['address_components']);

      // When the user selects an address from the drop-down, populate the
      // address fields in the form.
      autocomplete.addListener('place_changed', fillInAddress);
    }

    function fillInAddress() {
      // Get the place details from the autocomplete object.
      let cityInput = autocomplete.getPlace();

      for (let component in componentForm) {
        document.getElementById(component).value = '';
        document.getElementById(component).disabled = false;
      }

      // Get each component of the address from the place details,
      // and then fill-in the corresponding field on the form.
      for (let i = 0; i < cityInput.address_components.length; i++) {
        let addressType = cityInput.address_components[i].types[0];
        if (componentForm[addressType]) {
          let val = cityInput.address_components[i][componentForm[addressType]];
          document.getElementById(addressType).value = val;
        }
      }
    }

    // Bias the autocomplete object to the user's geographical location,
    // as supplied by the browser's 'navigator.geolocation' object.
    function geolocate() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          let geolocation = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
          let circle = new google.maps.Circle(
            {center: geolocation, radius: position.coords.accuracy});
          autocomplete.setBounds(circle.getBounds());
        });
      }
    }
    </script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key={{PLACES_API_KEY}}&libraries=places&callback=initAutocomplete"
        async defer></script>
  {% endblock %}
</body>
</html>
